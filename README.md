# Excel 批量更新工具

这是一个用于批量更新 Excel 文件的工具，可以根据 Master 总表的内容，自动更新目标文件夹中所有 Excel 文件的相应内容。

## 功能特点

- 支持批量处理多个 Excel 文件
- 保持原始文件格式不变
- 智能数据类型匹配
- 并行处理提高效率
- 详细的处理日志

## 使用说明

### Master 文件要求

1. Master 文件必须包含以下列：
   - 第一列：序号列（会被自动忽略）
   - 第二列：Key 列（用于匹配）
   - 第三列：中文内容列
   - 后续列：其他需要更新的内容列

### 目标文件要求

1. 目标文件必须为 Excel 格式（.xlsx 或 .xls）
2. 文件结构要求：
   - 第一列：Key 值（与 Master 文件中的 Key 相对应）
   - 第二列：中文内容（用于验证匹配）
   - 后续列：需要被更新的内容列

## 工作流程

1. **读取 Master 文件**
   - 删除第一列（序号列）
   - 验证必要列（Key 列）是否存在
   - 标准化数据，清理空白字符

2. **数据匹配规则**
   - 根据 Key 值匹配记录
   - 验证中文内容是否一致
   - 仅在 Key 和中文内容都匹配时进行更新

3. **数据更新逻辑**
   - 保持原始数据类型（数字保持数字，文本保持文本）
   - 智能处理空值和特殊字符
   - 保留原始单元格格式

4. **并行处理**
   - 使用线程池并行处理多个文件
   - 实时显示处理进度和结果

## 环境要求

- Python 3.6 或更高版本
- 依赖包：
  - pandas：数据处理
  - openpyxl：Excel 文件操作

## 使用方法

1. 运行程序后，点击"选择 Master 总表"按钮选择 Master 文件
2. 点击"选择目标文件夹"按钮选择需要更新的文件所在文件夹
3. 点击"开始处理"按钮开始更新操作
4. 等待处理完成，查看更新结果

## 注意事项

1. 建议在处理前备份目标文件
2. 确保 Master 文件和目标文件的编码格式一致
3. 处理过程中请勿手动修改相关文件