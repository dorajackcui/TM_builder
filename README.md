# Excel 批量更新工具

这是一个用于批量处理和更新 Excel 文件的工具。它可以根据 Master 文件中的数据，自动更新目标文件夹中所有 Excel 文件的相应内容。

## 安装说明

1. 确保已安装 Python 3.x
2. 安装所需依赖：
   ```bash
   pip install -r requirements.txt
   ```

## 使用方法

1. 运行程序：
   ```bash
   python main.py
   ```

2. 在程序界面中：
   - 点击「选择 Master 总表」选择主数据文件
   - 点击「选择目标文件夹」选择需要更新的文件所在文件夹
   - 设置匹配列索引（从1开始计数）
   - 点击「开始处理」执行更新

## 文件格式要求

### Master 文件要求
- 必须包含 'Key' 列
- 第一列（A列）将被自动忽略
- 其他列的数据将用于更新目标文件

### 目标文件要求
- 第一列必须是与 Master 文件对应的 Key
- 文件列数必须大于等于匹配列索引
- 支持 .xlsx 和 .xls 格式

## 更新规则

1. 程序会根据 Key 列和匹配列进行数据匹配：
   - Key 列：用于定位要更新的行
   - 匹配列：用于确认数据的正确性

2. 只有当以下条件都满足时，才会进行更新：
   - 目标文件中的 Key 在 Master 文件中存在
   - 匹配列的值完全相同

3. 数据更新时会保持原始数据类型：
   - 数字保持为数字
   - 文本保持为文本
   - 空值会被正确处理

## 注意事项

1. 使用前请确保：
   - Master 文件格式正确
   - 目标文件没有被其他程序打开
   - 有足够的磁盘空间

2. 建议在处理重要文件前：
   - 备份原始文件
   - 先用少量文件测试
   - 检查更新结果是否符合预期

3. 如遇到错误：
   - 检查文件格式是否符合要求
   - 确认匹配列索引设置正确
   - 查看程序输出的错误信息
